<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="../static/style.css">
</head>
<body>
<div class="header">
    <h1>Главная страница</h1>
    <p></p>
    <a href="{{ url_for('about') }}">О проекте</a>
</div>

<div class="main">
    <form action="/show_plot" method="POST">
        <fieldset>
            <legend>Выберите режим визуализации:</legend>

            <!-- Радиокнопка для показа всех месяцев -->
            <label>
                <input type="radio" name="mode" value="all_months" checked>
                Все месяцы
            </label><br>

            <!-- Радиокнопка для показа среднегодовых -->
            <label>
                <input type="radio" name="mode" value="annual">
                Среднегодовые показатели
            </label><br>

            <!-- Радиокнопка для диапазона годов -->
            <label>
                <input type="radio" name="mode" value="range">
                Диапазон годов и месяцев
            </label><br>

            <!-- Поля для диапазона годов и месяцев -->
            <div class="range-fields">
                <label>Начало:
                    <input type="month" name="start_date" id="start-date">
                </label><br>
                <label>Конец:
                    <input type="month" name="end_date" id="end-date">
                </label>
            </div>
        </fieldset>
        <button name="show_but" type="submit">Показать данные</button>
    </form>
    <!-- скрипт на JS: закомментированный вариант - внешнее подключение, текущий - встроенное -->
<!--    <script src="dateRange.js"></script>-->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const radios = document.querySelectorAll('input[name="mode"]');
            const rangeFields = document.querySelector('.range-fields');
            const startDateInput = document.getElementById('start-date');
            const endDateInput = document.getElementById('end-date');

            // Установить диапазон дат
            const today = new Date();
            const currentYear = today.getFullYear();
            const minYear = currentYear - 2;
            const maxYear = currentYear;

            const formatDate = (year, month) => `${year}-${month.toString().padStart(2, '0')}`;

            const minDate = formatDate(minYear, 1);
            const maxDate = formatDate(maxYear, 12);

            startDateInput.setAttribute('min', minDate);
            startDateInput.setAttribute('max', maxDate);
            endDateInput.setAttribute('min', minDate);
            endDateInput.setAttribute('max', maxDate);

            // Скрыть rangeFields по умолчанию
            if (!document.querySelector('input[name="mode"][value="range"]').checked) {
                rangeFields.style.display = 'none';
            }

            // Обработчик для радиокнопок
            radios.forEach(radio => {
                radio.addEventListener('change', () => {
                    if (document.querySelector('input[name="mode"][value="range"]').checked) {
                        rangeFields.style.display = 'block';
                    } else {
                        rangeFields.style.display = 'none';
                    }
                });
            });
        });
    </script>
</div>

<div class="footer">
    <p>2025 - Алексей Петров (А-13-21)</p>
</div>
</body>
</html>
